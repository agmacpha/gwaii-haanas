[["index.html", "Developing the ARU monitoring measures for Gwaii Haanas Preface 0.1 Open data 0.2 Objectives of WildTrax 0.3 Using this book", " Developing the ARU monitoring measures for Gwaii Haanas Alexander G. MacPhail 2021-03-31 Preface The purpose of this report is to satisfy the Scope of Work for a Contract with Gwaii Haanas National Park Reserve. The The Bioacoustic Unit (BU) is a collaboration between the Bayne Lab at the University of Alberta and the Alberta Biodiversity Monitoring Institute (ABMI) and focuses its research goals on the development and utilization of environmental sensor technology, as well as techniques and best practices for monitoring biodiversity in Canada. The BU has been mandated by this Contract to investigate ARU sampling efforts from 2010 to 2017 in Gwaii Haanas National Park Reserve by reporting on the summarized analysis and results, and to provide recommendations for improving the study design of the Gwaii Haanasâ€™s Ecological Integrity Breeding Bird Monitoring Program. The report aims to satisfy the following tasks as outlined in the Statement of Work: Objectives Describe the songbird community in the Juan Perez area of Haida Gwaii, determine its community stability over the 7-year sampling period and make recommendations on how to develop and employ a robust songbird monitoring program for Gwaii Haanas. Including methods for targeted searches for any songbirds listed as a conservation priority. Provide a report on the most appropriate methodology and tools needed to assess habitat use and population status for Northern Saw-whet Owl (NSWO) and Northern Goshawk (NOGO) in Gwaii Haanas. Scope of Work Identify songbirds and analyze and inventory all bird species, reporting on biodiversity and community structure over the sampling time. Make recommendations on a long-term monitoring design for assessing forest health with songbird data on Haida Gwaii including sample size, sampling frame, sampling frequency and report metric using ARUs. Include the results of the power analysis. Make recommendations for employing targeted assessments of songbird communities for species at risk surveys and restoration efforts. Report on any species at risk found in the recordings, including locations and recommendations for further research and monitoring Using automated recognition identify all NSWO on Graham Island (2012 - 2013) and Gwaii Haanas (2016 - 2017) Test human classification data from results in WildTrax against automated detection results; determine the strengths and weaknesses of both methods Provide advice on using ARUs to locate nests, assess habitat use and preference (including a power analysis where appropriate) for Northern Saw-whet Owl (NSWO) and Northern Goshawk (NOGO) in Gwaii Haanas 0.1 Open data Open data is data that can be accessed, re-used or redistributed by anyone and is freely available in a usable and convenient format. Openly shared data benefits the scientific community and society as a whole. Maximal data accessibility allows users (e.g., researchers, conservation practitioners and the public) to find, manipulate and analyze data, as well as link avian data to other types of information. Open data can lead directly to conservation knowledge and action. This requires data to be usable, inter-operable and reliable. The Bioacoustic Unit and WildTrax are proponents in making data as open and accessible as possible and many organizations in are shifting towards a more open, collaborative, co-produced framework in order to answers ecological questions. 0.2 Objectives of WildTrax To manage all components of environmental sensor and biological data from field metadata to media to species observations To store data safely and securely while still making it accessible to users To process environmental sensor data to a high degree of data quality and integrity To share environmental sensor and biological data with other WildTrax users, collaborators and the public 0.3 Using this book The goal of this book is to provide a comprehensive, accessible, engaging and referenceable set of documentation in order to satisfy the scope of this report. You can jump to different sections of the book using the links. WildTrax specific tools, functions or just general jargon is stylized like tasks or two-stage subsampling. Species are stylized like Ovenbird (OVEN), Wolverine or Tennessee Warbler (TEWA). The four-letter codes follow the most recent taxonomic workbench in WildTrax. Things specific to Gwaii Haanas are in purple. "],["introduction.html", "Chapter 1 Introduction 1.1 Overview of study area 1.2 Data management and processing", " Chapter 1 Introduction 1.1 Overview of study area Haida Gwaii is an isolated island archipelago 55 - 125 km west of continental North America (53.0,-134.0) separated by the Hecate Strait. The islands support habitat ranging from lowland muskeg, to wet coastal forest to rugged upland subalpine. The climate is driven by oceanic systems from the Pacific which are lifted by insular mountain ranges along the west side of the archipelago. These low-pressure oceanic systems bring moist, mild air onto the south and central coast in the winter, offset with infrequent high-pressure systems during the summer. These climatic and topographic conditions create rainshadows and micro-climates on the leeward side of Haida Gwaii. Extreme wind and wave exposure occurs on the west side of the archipelago with milder, more protected areas along the Hecate Strait and inshore areas. Sandy intertidal areas from freshwater fjords and river discharge provides spawning habitat for Pacific salmon and Pacific herring, an important food source for waterbirds. Sheltered inlets, inter-island channels and sounds also provide habitat for birds. 1.1.1 Ecoregions Two ecoregions, an area with major physiographic and minor macroclimatic or oceanographic variation defined at the regional level, represent the study area: the Gwaii Haanas Ecoregion (GWH) and the Hecate Strait Marine Ecoregion. The Hecate is a shallow strait dominated by coarse bottom sediments and surrounding coastal lowlands. The semi-protected and strong tidal currents promote mixing thereby fostering a neritic plankton community, nurseries for salmon and herring and abundant benthic invertebrate stocks. These create prime feeding grounds for marine mammals and birds. The Gwaii Haanas Ecoregion consists of two larger islands (Graham - Kiis Gwaay and Moresby - Gwaii Haanas) and over 150 smaller islands, islets and reefs. Ecoprovince Coast and Mountains Ecoprovince Ecoregions Gwaii Haanas Ecoregion (GWH) Ecosections Queen Charlotte Lowland (QCL) Queen Charlotte Ranges (QCR) Skidegate Plateau (SKP) Hecate Strait Marine Ecoregion The Queen Charlotte Lowland is an area of low relief, poorly drained, extensive muskegs and wetlands in the northeastern part of Haida Gwaii. The area lies in a slight rainshadow of the Queen Charlotte Ranges to the west however Pacific air can easily flow bringing intense rainfall and cloud cover. Wet coastal Western Hemlock forests are abundant with much of the upland being muskeg or wetlands. This area has been the most impacted by recent anthropogenic activities as well such as forest harvesting and livestock grazing on a very small scale. Lowland habitats in rocky islets, shoreline cliffs, usually with herbaceous or shrubby vegetative cover, provides important bird nesting and roosting habitat. The Queen Charlotte Ranges are a very wet, rugged region with steep, forested slopes, dissected by deep sounds, channels and fjords. The area was once actively logged but has now been replaced with conservancies and Gwaii Haanas National Park Reserve. The Skidegate Plateau is a dissected plateau between the QCR to the west and the lower lying areas of Haida Gwaii to the east. Both the QCR and SKP are dominated by wet coastal hemlock and mountain hemlock biogeoclimatic zones at higher elevations. #All locations were located on the Haida Gwaii archipelago. This is located within the Coast and Mountain Ecoprovince (COM), and the Gwaii Haanas (GWH) and Hecate Strait Marine Ecoregions. # Areas are further subdivided into ecosections and plant communities as defined by Golumbia 2001. library(sf) library(bcmaps) library(bcmapsdata) library(vegan) library(plotly) library(tidyverse) ghnp &lt;- read_csv(&quot;/users/alexandremacphail/gwaii-haanas/allghnp.csv&quot;) ghnp_l &lt;- ghnp %&gt;% dplyr::select(location_name, location_latitude, location_longitude) %&gt;% distinct() %&gt;% filter(!is.na(location_latitude)) ecoreg &lt;- ecoregions() ecoprov &lt;- ecoprovinces() ecosec &lt;- ecosections() h0 &lt;- transform_bc_albers(st_as_sf(ghnp_l, coords=c(&quot;location_longitude&quot;,&quot;location_latitude&quot;), crs=4326)) h0 &lt;- h0 %&gt;% mutate(lead = geometry[row_number() + 1], dist = st_distance(geometry, lead, by_element = T),) %&gt;% dplyr::select(-lead) h &lt;- st_buffer(h0,150) ghpc &lt;- transform_bc_albers(st_read(&quot;/users/alexandremacphail/gwaii-haanas/gis/GHPlantCommunities_Golumbia01.shp&quot;, quiet = TRUE) %&gt;% st_transform(crs=4326) %&gt;% st_make_valid()) %&gt;% na.omit() # ocean &lt;- st_combine(st_crop(transform_bc_albers(st_read(&quot;/users/alexandremacphail/GH/GH/gis/lhy_000h16a_e.shp&quot;, quiet=TRUE) %&gt;% st_transform(crs=4326) %&gt;% st_make_valid()), xmin = 529366.8, ymin = 781438.2, xmax = 748180.7, ymax = 1059955)) # map &lt;- ggplotly(ggplot() + # geom_sf(data = subset(ecosec, ECOSECTION_NAME %in% c(&quot;Skidegate Plateau&quot;,&quot;Hecate Strait&quot;,&quot;Queen Charlotte Lowland&quot;,&quot;Queen Charlotte Ranges&quot;)), aes(colour = ECOSECTION_NAME, fill=NA)) + # geom_sf(data = ghpc, colour = &quot;#A19E99&quot;, size = 0.2, aes(fill = HABITAT), alpha = 0.5) + # geom_sf(data = h, colour = &quot;red&quot;, fill=NA) + # coord_sf(crs = 3005, xlim= c(522000,670000), ylim = c(775000,1057000), expand = F) + # scale_fill_viridis_d(guide = guide_legend()) + # scale_colour_viridis_d(guide = guide_legend()) + # ggtitle(&quot;Haida Gwaii survey locations&quot;) + # theme_bw()) # # htmlwidgets::saveWidget(map, file = &quot;/users/alexandremacphail/gwaii-haanas/map.html&quot;) # webshot::webshot(url = &quot;/users/alexandremacphail/gwaii-haanas/map.html&quot;, file = &quot;/users/alexandremacphail/gwaii-haanas/map.png&quot;, delay = 1, zoom = 4) 1.1.2 Forest and plant communities The vegetation and forest type is dominated by Coastal Western Hemlock, Mountain Hemlock and Alpine Tundra Biogeoclimatic zones with increasing elevation and with decreasing representation on the landscape. 1.1.3 Avifauna on Haida Gwaii 287 species are known to be found on Haida Gwaii. 252 of these species are known breeders. Of the diverse community of species encountered on Haida Gwaii, 93 songbirds are known to be residents, migrants and breeders on the islands. Certain species such as Townsendâ€™s Warbler\" and Pacific-slope Flycatcher\" are known to be high-density residents on the archipelago. Many unique subspecies of resident non-passerines, especially raptors are noted (NSWO, NOGO, WESO). 4 introduced species (House Sparrow, European Starling, Rock Pigeon, Eurasian Collared-Dove). #List of species on Haida Gwaii hgspp &lt;- read_csv(&quot;/users/alexandremacphail/gwaii-haanas/hgspp/avibasehg2.csv&quot;) %&gt;% as_tibble() # Yes means confirmed breeder, migrant or resident # Rare / Accidental # Yes_d was changed from Rare / Accdidental -&gt; Yes for TOWA, CHSP, WETA # Rare / Accidental_m is for NOFU # COSEWIC and BC Provincial statuses are included # Count of residents, migrants and breeders - 252 in total hgspp %&gt;% group_by(on_haida_gwaii) %&gt;% summarise(n = n()) %&gt;% mutate(freq = n / sum(n())) ## # A tibble: 5 x 3 ## on_haida_gwaii n freq ## * &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Introduced species 4 0.8 ## 2 Rare/Accidental 30 6 ## 3 Rare/Accidental_m 1 0.2 ## 4 Yes 249 49.8 ## 5 Yes_d 3 0.6 # Count of passerine (songbird) species - 93 in total hgspp %&gt;% filter(species_order == &quot;Passeriformes&quot;) %&gt;% group_by(on_haida_gwaii) %&gt;% tally() %&gt;% ungroup() ## # A tibble: 4 x 2 ## on_haida_gwaii n ## * &lt;chr&gt; &lt;int&gt; ## 1 Introduced species 1 ## 2 Rare/Accidental 11 ## 3 Yes 90 ## 4 Yes_d 3 knitr::kable( head(hgspp, booktabs = TRUE, caption = &#39;List of avifauna on Haida Gwaii. COSEWIC and British Columbia Provincial Statuses are also included.&#39; )) species_english_name on_haida_gwaii cosewic_status provincial_status species_order species_family Aleutian Tern Yes 0 SNA Charadriiformes Laridae American Coot Yes Not at Risk S4S5B Gruiformes Rallidae American Dipper Yes 0 S4 Passeriformes Cinclidae American Golden-Plover Yes 0 S3S4B Charadriiformes Charadriidae American Goldfinch Yes 0 S4 Passeriformes Fringillidae American Kestrel Yes 0 S4S5B Falconiformes Falconidae 1.2 Data management and processing Data required some standardization prior to proceeding with transcription and analysis. WildTrax was used to manage, store, process, centralize and subsequently share data with other users and collaborators. WildTrax requires certain metadata standards which can be summarized in the 1st edition of WildTrax: The Definitive Guide. 1.2.1 Location standardization Each location, a geographic and physical place on the landscape, was given a unique name. All raw acoustic recordings collected at each of these locations was then attributed these names. This created a unique spatial and temporal key to all of the acoustic data in the format of (LOCATION_YYYYMMDD_HHMMSS). The prefix GHNPR to denote points within the bounds of Gwaii Haanas National Park Reserve and HGBC to denote points outside the park, principally those associated with the Northern Saw-whet Owl project on Graham Island. 1.2.2 Acoustic transcription Community data were managed, stored, processed and quality controlled using WildTrax. Data were associated to each of 10 projects as follows: Night Birds Returning (2010) Night Birds Returning (2011) Night Birds Returning (2012) Night Birds Returning (2013) Night Birds Returning (2014) Night Birds Returning and Restoring Balance (2015) Graham Island Northern Saw-whet Owl Territory Pilot Study (2012 - 2013) Marbled Murrelet Pilot Study (2016) EI Grid Pilot Study (2016) EI Grid Alpine Pilot (2017) "],["songbird-community.html", "Chapter 2 Songbird community 2.1 Methods 2.2 Results", " Chapter 2 Songbird community library(tidyverse) library(sf) library(tidyverse) library(broom.mixed) library(vegan) library(lme4) library(MuMIn) library(multcomp) library(MASS) library(fitdistrplus) library(bcmaps) library(bcmapsdata) library(vegan) library(plotly) ghnp &lt;- read_csv(&quot;/users/alexandremacphail/gwaii-haanas/allghnp.csv&quot;) ghnp &lt;- ghnp %&gt;% mutate(passerine = case_when( species_order == &quot;PASSERIFORMES&quot; ~ &quot;Yes&quot;, TRUE ~ &quot;No&quot; )) #This is a list of codes used in WildTrax to tag abiotic events like weather, traffic, industrial noise or background noise abiotic_codes&lt;-c(&#39;LIBA&#39;,&#39;MOBA&#39;,&#39;HEBA&#39;,&#39;LITR&#39;,&#39;MOTR&#39;,&#39;HETR&#39;,&#39;LINO&#39;,&#39;MONO&#39;,&#39;HENO&#39;,&#39;LIRA&#39;,&#39;MORA&#39;,&#39;HERA&#39;,&#39;LIWI&#39;,&#39;MOWI&#39;,&#39;HEWI&#39;,&#39;LIAI&#39;,&#39;MOAI&#39;,&#39;HEAI&#39;,&#39;LITN&#39;,&#39;MOTN&#39;,&#39;HETN&#39;,&#39;LIDT&#39;,&#39;MODT&#39;,&#39;HEDT&#39;,&#39;LITF&#39;,&#39;MOTF&#39;,&#39;HETF&#39;) #This is the current list of mammals in the acoustic species table in WildTrax mammals&lt;-c(&#39;AMPK&#39;,&#39;SHEP&#39;,&#39;RESQ&#39;,&#39;BEAV&#39;,&#39;COYT&#39;,&#39;FISH&#39;,&#39;GROU&#39;,&#39;HARE&#39;,&#39;LECH&#39;,&#39;MULE&#39;,&#39;MUSK&#39;,&#39;OTTE&#39;,&#39;PORC&#39;,&#39;REFX&#39;,&#39;SKNK&#39;,&#39;WOLF&#39;,&#39;WTDE&#39;,&#39;BADG&#39;,&#39;HOAR&#39;,&#39;MART&#39;,&#39;MOOS&#39;,&#39;CARI&#39;,&#39;CATT&#39;,&#39;COWW&#39;,&#39;DASH&#39;,&#39;ELKK&#39;,&#39;GOAT&#39;,&#39;GRBE&#39;,&#39;PIGG&#39;,&#39;RMBH&#39;,&#39;MOGO&#39;,&#39;COPI&#39;,&#39;FRBA&#39;,&#39;KEMY&#39;,&#39;LBBA&#39;,&#39;LEBA&#39;,&#39;LLBA&#39;,&#39;PABA&#39;,&#39;SHBA&#39;,&#39;SPOB&#39;,&#39;WSFB&#39;,&#39;YUMY&#39;,&#39;CAMY&#39;,&#39;ESFB&#39;,&#39;TCBA&#39;,&#39;WRBA&#39;,&#39;ERBA&#39;,&#39;ABBE&#39;,&#39;BBBA&#39;,&#39;NLEM&#39;,&#39;DOGG&#39;,&#39;TBEB&#39;,&#39;AGSQ&#39;,&#39;HOMA&#39;,&#39;SIVO&#39;,&#39;EGSQ&#39;,&#39;WGSQ&#39;,&#39;MGSQ&#39;,&#39;ASSS&#39;,&#39;CHIK&#39;,&#39;HORS&#39;) amphs&lt;-c(&#39;WETO&#39;,&#39;CATO&#39;,&#39;GPTO&#39;,&#39;CSFR&#39;,&#39;BCFR&#39;,&#39;WOFR&#39;,&#39;PLSP&#39;,&#39;NLFR&#39;) #List of species on Haida Gwaii hgspp &lt;- read_csv(&quot;/users/alexandremacphail/gwaii-haanas/hgspp/avibasehg2.csv&quot;) %&gt;% as_tibble() # Yes means confirmed breeder, migrant or resident # Rare / Accidental # Yes_d was changed from Rare / Accdidental -&gt; Yes for TOWA, CHSP, WETA # Rare / Accidental_m is for NOFU # COSEWIC and BC Provincial statuses are included 2.1 Methods All community transcription data (all projects, year, etc.) were included in the analysis. In order to determine community stability, each ARU location was included as a random effect to account for non-independence of the sampling units within and between years. Species richness was used to measure changes in number of species per sampling location per year. We measured the number of distinct species observed over all visits at each location using and using generalized linear models (GLMs) with Gaussian distribution fit the data using a series of forward stepwise model selection. Akaikeâ€™s Information Criterion (AIC) was used to select the best model (rank_year + HABITAT + (1 | location_name). We also fit the model to ensure overdispersion of parameters was not violated. Furthemore, a generalized linear hypothesis test (GLHT) using a Tukey single-step multiple comparison procedure and statistical test to find differences in the mean species richness across years. ghnp_l &lt;- ghnp %&gt;% dplyr::select(location_name, location_latitude, location_longitude) %&gt;% distinct() %&gt;% filter(!is.na(location_latitude)) ecoreg &lt;- ecoregions() ecoprov &lt;- ecoprovinces() ecosec &lt;- ecosections() h0 &lt;- transform_bc_albers(st_as_sf(ghnp_l, coords=c(&quot;location_longitude&quot;,&quot;location_latitude&quot;), crs=4326)) # h0 &lt;- h0 %&gt;% # mutate(lead = geometry[row_number() + 1], # dist = st_distance(geometry, lead, by_element = T),) %&gt;% # dplyr::select(-lead) h &lt;- st_buffer(h0,150) ghpc &lt;- transform_bc_albers(st_read(&quot;/users/alexandremacphail/gwaii-haanas/gis/GHPlantCommunities_Golumbia01.shp&quot;, quiet = TRUE) %&gt;% st_transform(crs=4326) %&gt;% st_make_valid()) %&gt;% na.omit() # Clean up data from import g2a &lt;- ghnp %&gt;% dplyr::select(project_full_nm, species_code, species_english_name, passerine, individual, location_name, location_latitude, location_longitude, recording_date, abundance_type, confidence_type, method_type, user_name) %&gt;% distinct() %&gt;% filter(!species_code %in% abiotic_codes, !species_code %in% mammals, !species_code %in% amphs, !grepl(&#39;UN^&#39;,species_code)) %&gt;% mutate(year = lubridate::year(recording_date), hour = lubridate::hour(recording_date), julian = lubridate::yday(recording_date)) %&gt;% dplyr::select(location_name, year, recording_date, julian, hour, species_code, species_english_name, passerine, individual, abundance_type) #Merge species table g3a &lt;- g2a %&gt;% dplyr::left_join(dplyr::select(hgspp, species_english_name, on_haida_gwaii), by = c(&quot;species_english_name&quot; = &quot;species_english_name&quot;)) %&gt;% filter(passerine == &quot;Yes&quot;) write.csv(g3a, &quot;/users/alexandremacphail/desktop/ghspp.csv&quot;) #Intersect the buffered locations with the plant communities layer to get habitat type ints &lt;- st_intersection(ghpc, h) %&gt;% mutate(intersect_area = st_area(.)) %&gt;% dplyr::select(HABITAT, location_name, intersect_area) %&gt;% st_drop_geometry() %&gt;% as_tibble() %&gt;% mutate(ia = as.integer(intersect_area), prop = round((ia / 70685.83),5)) %&gt;% inner_join(., g3a, by = c(&quot;location_name&quot; = &quot;location_name&quot;)) %&gt;% dplyr::select(location_name, year, recording_date, HABITAT, prop, species_code, individual, abundance_type, julian, hour) %&gt;% mutate(individual = case_when( abundance_type == &quot;TMTC&quot; ~ 4, #Conditional based on spp richness? abundance_type == &quot;CI 1&quot; ~ 1, abundance_type == &quot;CI 2&quot; ~ 5, abundance_type == &quot;CI 3&quot; ~ 20, TRUE ~ as.numeric(individual))) %&gt;% dplyr::select(location_name, year, recording_date, HABITAT, prop, julian, hour, species_code, individual) %&gt;% distinct() %&gt;% group_by(location_name, year) %&gt;% mutate(alpha_loc = n_distinct(species_code)) %&gt;% ungroup() boxplot(alpha_loc ~ HABITAT, ints) # GLMs for alpha diversity over years ints$rank_year &lt;- factor(ints$year) #create a factor for year ml0 &lt;- glm(alpha_loc ~ 1, data = ints, family = gaussian) ml1 &lt;- glm(alpha_loc ~ rank_year, data = ints, family = gaussian) ml2 &lt;- lmer(alpha_loc ~ rank_year + (1|location_name), data = ints) #why doesn&#39;t this work? it is because location_name is random effect? ml3 &lt;- lmer(alpha_loc ~ rank_year + HABITAT + (1|location_name), data = ints) model.sel(ml0, ml1, ml2, ml3) ## Model selection table ## (Int) rnk_yer HAB family class random df logLik AICc delta weight ## ml2 10.710 + gaussian(identity) lmerMod l_n 8 -1600.883 3217.8 0.00 1 ## ml3 9.259 + + gaussian(identity) lmerMod l_n 19 -1610.207 3258.7 40.92 0 ## ml1 12.830 + gaussian(identity) glm 7 -5278.273 10570.6 7352.77 0 ## ml0 9.553 gaussian(identity) glm 2 -6127.490 12259.0 9041.16 0 ## Models ranked by AICc(x) ## Random terms: ## l_n = &#39;1 | location_name&#39; #ml2 wins for alpha location richness #Test for overdispersion overdisp_fun &lt;- function(model) { rdf &lt;- df.residual(model) rp &lt;- residuals(model,type=&quot;pearson&quot;) Pearson.chisq &lt;- sum(rp^2) prat &lt;- Pearson.chisq/rdf pval &lt;- pchisq(Pearson.chisq, df=rdf, lower.tail=FALSE) c(chisq=Pearson.chisq,ratio=prat,rdf=rdf,p=pval) } overdisp_fun(ml2) ## chisq ratio rdf p ## 440.8567136 0.1920944 2295.0000000 1.0000000 #Yikes extremely overdispersed #Fit the overdispersion to the model tidy_quasi &lt;- function(model, phi=overdisp_fun(model)[&quot;ratio&quot;], conf.level=0.95) { tt &lt;- (tidy(model, effects=&quot;fixed&quot;) %&gt;% mutate(std.error=std.error*sqrt(phi), statistic=estimate/std.error, p.value=2*pnorm(abs(statistic), lower.tail=FALSE)) ) return(tt) } tq2 &lt;- tidy_quasi(ml2) #Print the results tq2 ## # A tibble: 6 x 6 ## effect term estimate std.error statistic p.value ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 fixed (Intercept) 10.7 0.194 55.3 0. ## 2 fixed rank_year2011 -6.85 0.0563 -122. 0. ## 3 fixed rank_year2012 -5.76 0.0249 -231. 0. ## 4 fixed rank_year2013 -3.71 1.11 -3.35 8.22e- 4 ## 5 fixed rank_year2016 -1.13 0.316 -3.57 3.56e- 4 ## 6 fixed rank_year2017 -4.41 0.396 -11.1 7.88e-29 #Run general linear hypothesis testing on the models lmod2 &lt;- glht(ml2, linfct=mcp(rank_year=&quot;Tukey&quot;)) out2 &lt;- summary(lmod2, test = adjusted(&quot;none&quot;)) out2 ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lmer(formula = alpha_loc ~ rank_year + (1 | location_name), data = ints) ## ## Linear Hypotheses: ## Estimate Std. Error z value Pr(&gt;|z|) ## 2011 - 2010 == 0 -6.84923 0.12838 -53.352 &lt; 2e-16 *** ## 2012 - 2010 == 0 -5.75858 0.05684 -101.321 &lt; 2e-16 *** ## 2013 - 2010 == 0 -3.70873 2.52947 -1.466 0.142592 ## 2016 - 2010 == 0 -1.12944 0.72167 -1.565 0.117578 ## 2017 - 2010 == 0 -4.40717 0.90253 -4.883 1.04e-06 *** ## 2012 - 2011 == 0 1.09065 0.11802 9.241 &lt; 2e-16 *** ## 2013 - 2011 == 0 3.14050 2.53174 1.240 0.214808 ## 2016 - 2011 == 0 5.71979 0.72958 7.840 4.44e-15 *** ## 2017 - 2011 == 0 2.44205 0.90886 2.687 0.007211 ** ## 2013 - 2012 == 0 2.04985 2.52932 0.810 0.417690 ## 2016 - 2012 == 0 4.62915 0.72115 6.419 1.37e-10 *** ## 2017 - 2012 == 0 1.35141 0.90211 1.498 0.134121 ## 2016 - 2013 == 0 2.57929 2.55515 1.009 0.312759 ## 2017 - 2013 == 0 -0.69845 2.61200 -0.267 0.789161 ## 2017 - 2016 == 0 -3.27774 0.97216 -3.372 0.000747 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- none method) #Plot the raw data results r &lt;- ints %&gt;% dplyr::select(location_name, year, HABITAT, alpha_loc) %&gt;% distinct() #Alpha richness each visits ggplot(r, aes(x=year, y=alpha_loc, colour=HABITAT)) + geom_boxplot(aes(group=year)) + geom_jitter(alpha = 0.2) + theme_bw() + scale_colour_viridis_d() + theme(legend.position = &quot;none&quot;) #Alpha richness each location ggplot(r, aes(x=year, y=alpha_loc, fill=HABITAT)) + geom_boxplot(aes(group=year)) + geom_jitter(alpha = 0.2) + theme_bw() + facet_wrap(~HABITAT) + scale_colour_viridis_d() + theme(legend.position = &quot;none&quot;) 2.1.1 Effect of proximity to ocean on detection probability 2.1.2 Single-species models In order to determine if individual species abundances changed over time, a generalized linear mixed model (GLMM) with Poisson distribution was used to fit the data. ispp &lt;- ints %&gt;% dplyr::select(location_name, rank_year, HABITAT, alpha_loc, julian, hour, species_code, individual) %&gt;% group_by(location_name, rank_year, HABITAT, species_code) %&gt;% mutate(individual = max(individual)) %&gt;% ungroup() %&gt;% group_by(species_code) %&gt;% add_tally(name = &#39;sppcount&#39;) %&gt;% filter(sppcount &gt; 50) ggplot(ispp, aes(x=rank_year, y=individual, fill=rank_year)) + geom_boxplot(aes(group = rank_year)) + geom_jitter(alpha = 0.2) + theme_bw() + scale_fill_viridis_d() + facet_wrap(~species_code, scales = &quot;free_x&quot;) ggplot(ispp, aes(x=julian, fill=species_code)) + geom_density(alpha = 0.5) + theme_bw() + scale_fill_viridis_d() + facet_wrap(~species_code, scales = &quot;free_x&quot;) ggplot(ispp, aes(x=hour, fill=species_code)) + geom_density(alpha = 0.5) + theme_bw() + scale_fill_viridis_d() + facet_wrap(~species_code, scales = &quot;free_x&quot;) plot(ispp$individual) m0 &lt;- glm(individual ~ 1, data = ispp, family = poisson) m1 &lt;- glm(individual ~ rank_year, data = ispp, family = poisson) m2 &lt;- glm(individual ~ rank_year + HABITAT, data = ispp, family = poisson) m3 &lt;- glm(individual ~ rank_year * HABITAT, data = ispp, family = poisson) m4 &lt;- glmer(individual ~ rank_year + HABITAT + (1|location_name), data = ispp, family = poisson) ## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to ## converge with max|grad| = 0.00359839 (tol = 0.002, component 1) m5 &lt;- glmer(individual ~ rank_year * HABITAT + (1|location_name), data = ispp, family = poisson) ## fixed-effect model matrix is rank deficient so dropping 50 columns / coefficients ## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to ## converge with max|grad| = 0.00335193 (tol = 0.002, component 1) m1nb &lt;- glmer.nb(individual ~ rank_year + (1|location_name), data = ispp) ## Warning in theta.ml(Y, mu, weights = object@resp$weights, limit = limit, : iteration limit reached model.sel(m0, m1, m2, m3, m4, m5, m1nb) ## Model selection table ## (Int) rnk_yer HAB HAB:rnk_yer family class random df logLik ## m1nb 0.7623 + Negative Binomial(281608.6,log) glmerMod l_n 8 -2918.123 ## m4 0.1498 + + poisson(log) glmerMod l_n 18 -2915.919 ## m1 0.7850 + poisson(log) glm 6 -2929.872 ## m5 0.1556 + + + poisson(log) glmerMod l_n 23 -2913.865 ## m2 0.1521 + + poisson(log) glm 17 -2923.600 ## m3 0.1525 + + + poisson(log) glm 22 -2919.627 ## m0 0.6557 poisson(log) glm 1 -2951.354 ## AICc delta weight ## m1nb 5852.3 0.00 1 ## m4 5868.2 15.86 0 ## m1 5871.8 19.47 0 ## m5 5874.3 21.96 0 ## m2 5881.5 29.19 0 ## m3 5883.8 31.44 0 ## m0 5904.7 52.39 0 ## Models ranked by AICc(x) ## Random terms: ## l_n = &#39;1 | location_name&#39; 2.1.3 Community structure Community composition between habitat types was tested using a redundancy analysis (RDA). The RDA summarizes the variation in a set of response variables, here species presence and abundance, and determines the amount of variation in species abundance data that is explained by environmental variables, The data is then shown in the parsimonious multivariate space to visually depict similarities and shifts in community composition across habitat types. Results from the RDA were presented as an ordination with 67% confidence ellipses to show where the majority of the location of each habitat type were located in two-dimensional space. #Setup the community matrix with the variables of interest i2 &lt;- ints %&gt;% dplyr::select(location_name, HABITAT, prop, species_code, individual, recording_date) %&gt;% distinct() %&gt;% mutate(year = lubridate::year(recording_date)) %&gt;% group_by(location_name, year, HABITAT, prop, species_code) %&gt;% mutate(individual = max(individual)) %&gt;% ungroup() %&gt;% group_by(location_name, year) %&gt;% mutate(alpha_loc = n_distinct(species_code)) %&gt;% ungroup() %&gt;% distinct() %&gt;% pivot_wider(names_from = species_code, values_from = individual, values_fill = 0) %&gt;% as_tibble() %&gt;% mutate_if(is.integer, as.numeric) multi_type &lt;- i2 %&gt;% dplyr::select(location_name, HABITAT, prop, recording_date, alpha_loc, year) %&gt;% distinct() write.csv(i2,&quot;/users/alexandremacphail/desktop/ghwide.csv&quot;) write.csv(multi_type,&quot;/users/alexandremacphail/desktop/ghwideplus.csv&quot;) #Let&#39;s do a quick species accumulation curve plot(vegan::specaccum(i2[,-c(1:6)], method=&quot;random&quot;)) #Run the ordination t3 &lt;- vegan::rda(i2[, -c(1:6)] ~ HABITAT, data = multi_type) #The stepwise model vegan::ordistep(t3, permutations = 999) ## ## Start: i2[, -c(1:6)] ~ HABITAT ## ## Df AIC F Pr(&gt;F) ## - HABITAT 11 1053.1 5.6189 0.001 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## Call: rda(formula = i2[, -c(1:6)] ~ HABITAT, data = multi_type) ## ## Inertia Proportion Rank ## Total 8.6367 1.0000 ## Constrained 0.9926 0.1149 11 ## Unconstrained 7.6441 0.8851 44 ## Inertia is variance ## ## Eigenvalues for constrained axes: ## RDA1 RDA2 RDA3 RDA4 RDA5 RDA6 RDA7 RDA8 RDA9 RDA10 RDA11 ## 0.5755 0.2910 0.0587 0.0291 0.0129 0.0117 0.0078 0.0037 0.0016 0.0005 0.0002 ## ## Eigenvalues for unconstrained axes: ## PC1 PC2 PC3 PC4 PC5 PC6 PC7 PC8 ## 2.0212 1.2389 0.7934 0.5818 0.4652 0.4369 0.3935 0.3351 ## (Showing 8 of 44 unconstrained eigenvalues) #Set things up for graphics t3scores &lt;- scores(t3, display = &quot;sites&quot;) %&gt;% as.data.frame() %&gt;% rownames_to_column(&quot;site&quot;) %&gt;% bind_cols(., multi_type) t3vect &lt;- scores(t3, display = &quot;species&quot;) %&gt;% as.data.frame() plot_RDA &lt;- ggplot(data = t3scores, aes(x = RDA1, y = RDA2)) + geom_point(data = t3scores, aes(x = RDA1, y = RDA2, colour = HABITAT), alpha = 0.6) + stat_ellipse( data = t3scores, aes(colour = HABITAT), linetype = 4, type = &#39;norm&#39;, level = 0.67 ) + scale_colour_viridis_d(guide = guide_legend()) + geom_vline(xintercept = c(0), color = &quot;#A19E99&quot;, linetype = 2) + geom_hline(yintercept = c(0), color = &quot;#A19E99&quot;, linetype = 2) + geom_segment( data = t3vect, aes( x = 0, y = 0, xend = RDA1, yend = RDA2 ), arrow = arrow(length = unit(0.2, &quot;cm&quot;)), alpha = 0.2 ) + geom_text(data = t3vect, aes( x = RDA1, y = RDA2, label = rownames(t3vect), alpha = 0.2 )) + theme_bw() + labs(x = paste0(&quot;CA1 &quot;, round(t3$CA$eig[[1]], 2), &#39;%&#39;), y = paste0(&quot;CA2 &quot;, round(t3$CA$eig[[2]], 2), &#39;%&#39;)) + ggtitle(&quot;Haida Gwaii species communities&quot;) #Plot the RDA rda &lt;- ggplotly(plot_RDA) htmlwidgets::saveWidget(rda, &quot;/users/alexandremacphail/gwaii-haanas/rda.html&quot;) 2.2 Results 2.2.1 Community stability Here we will report on the community stability based on the final results. 2.2.2 Monitoring program Here we will make recommendations on employing a robust, long-term monitoring program to assess forest health and songbirds. Sample size Time frame Frequency Report metric Abundance Richness ##Occupancy## "],["habitat-use.html", "Chapter 3 Habitat use 3.1 Assessing habitat use and population status of Northern Goshawk and Northern Saw-whet on Haida Gwaii", " Chapter 3 Habitat use 3.1 Assessing habitat use and population status of Northern Goshawk and Northern Saw-whet on Haida Gwaii We performed community transcription at the location on Graham Island. library(tidyverse) nswo_data &lt;- read_csv(&quot;NSWO-GHNPR.csv&quot;) n2 &lt;- nswo_data %&gt;% mutate(fp = str_remove(file_path,&quot;\\\\_d&quot;), year = lubridate::year(recording_date_time), hour = lubridate::hour(recording_date_time)) ggplot(n2, aes(x=location, y=recording_date_time)) + geom_point() + coord_flip() ggplot(n2, aes(x=recording_date_time, y=hour, color=location)) + geom_point() + geom_jitter() + coord_flip() n3 &lt;- n2 %&gt;% group_by(location, julian, hour) %&gt;% add_tally(name = &quot;group&quot;) %&gt;% ungroup() %&gt;% group_by(location, group) %&gt;% slice_sample(n = 24, weight_by = group, replace = F) ggplot(n3, aes(x=location, y=recording_date_time)) + geom_point() + coord_flip() ggplot(n3, aes(x=recording_date_time, y=hour, color=location)) + geom_point() + geom_jitter() + coord_flip() n4 &lt;- n2 %&gt;% filter(julian %in% c(60:220), hour %in% c(3:10,19:22)) %&gt;% group_by(location, time_index) %&gt;% slice_sample(n = 8, replace = F) ggplot(n4, aes(x=location, y=recording_date_time)) + geom_point() + coord_flip() ggplot(n4, aes(x=recording_date_time, y=hour, color=location)) + geom_point() + coord_flip() nswo_tasks &lt;- bind_rows(n3, n4) %&gt;% mutate(script = paste0(&quot;sudo ln -s &quot;,file_path,&quot; /media/BUdata01/wildtrax_loads/nswo_ghnpr/&quot;,file_name,&quot;.&quot;,file_type)) write.csv(nswo_tasks$script, &quot;nswo.txt&quot;, row.names=F, quote = F) sum(nswo_data$length_seconds)/3600 ## [1] 16622 "],["conclusions.html", "Chapter 4 Conclusions 4.1 Recommendations", " Chapter 4 Conclusions 4.1 Recommendations 4.1.1 Equipment servicing Equipment servicing is important to extend the life of the environmental sensor being used. Specifically, with ARUs, the calibration of microphones is important. Here are some recommendations: Turgeon et al. 2017 Bioacoustic Unit Deployment Protocols Provide recommendations for coastal forest Try monitoring NOFU on north point breeding potential Hide tide low tide effects LDFCs for abiotics "],["references.html", "References", " References "]]
